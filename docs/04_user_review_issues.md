# ユーザーレビュー課題対応方針書

作成日: 2025-08-05  
対応者: Claude Code  
対象: フェーズ3（ユーザーレビュー対応）

## 概要

本ドキュメントは、ユーザーの動作確認で報告された課題に対する調査結果と修正方針をまとめたものです。

## 報告された課題一覧

### 1. 問題画面の選択肢インデックス表示（優先度: 高）

#### 課題内容
- 「選択中: 1」という表示が選択肢のインデックス表記と一致していない
- 「あなたの回答: A」「正解: A」という表示が、実際の選択肢に A, B, C の表記がないため混乱を招く

#### 調査結果
- **QuestionCard.tsx**: 86-90行目で「選択中: {props.selectedOptions.join(", ")}」として数値インデックスを表示
- **AnswerOptions.tsx**: 166-178行目で回答後に「正解: A」形式で表示しているが、選択肢自体にはA,B,C表記なし
- 選択肢には○/●（単一選択）、☐/☑（複数選択）のアイコンのみ表示

#### 修正方針
- QuestionCard.tsx の「選択中」表示を削除（86-90行目のコメントにある通り「本番では削除可能」）
- AnswerOptions.tsx の選択肢に A, B, C... のラベルを常時表示
- 回答後の「正解」「あなたの回答」表示は維持（A, B, C表記との整合性確保後）

### 2. ホーム画面のカテゴリ進捗表示（優先度: 高）

#### 課題内容
- 進捗が「2/2」で「進行中」と表示される（「完了」であるべき）
- 完了時は「続きから」ではなく「もう一度」ボタンを表示すべき

#### 調査結果
- **CategoryCard.tsx**: 
  - 59-67行目で `isCompleted` の場合「完了」バッジを表示（正常）
  - 63-67行目で `hasProgress && !isCompleted` の場合「進行中」バッジを表示
  - 75-86行目でボタン表示ロジックに問題：`isCompleted` でも「再挑戦」ではなく「続きから」を表示する条件あり

#### 修正方針
- CategoryCard.tsx のボタン表示ロジックを修正：
  - 完了時: 「もう一度」ボタンを表示
  - 進行中: 「続きから」ボタンを表示
  - 未開始: 「開始」ボタンを表示

### 3. 「問題一覧」ボタンの実装状況（優先度: 中）

#### 課題内容
- 「問題一覧」ボタンを押しても遷移しない

#### 調査結果
- **CategoryCard.tsx**: 89行目で `/category/${props.category.id}` へのリンクを実装
- **App.tsx**: 63行目で `/category/:categoryId` ルートが CategoryList コンポーネントにマッピング
- 問題: カテゴリ別問題一覧用の専用コンポーネントが未実装

#### 修正方針
- カテゴリ別問題一覧は現在の要件には含まれていない
- 「問題一覧」ボタンを削除するか、今後の実装予定として無効化

### 4. 進捗率が100%を超える問題（優先度: 高）

#### 課題内容
- 進捗が「3/2」のように100%を超えて表示される

#### 調査結果
- **quiz-store.ts**: 
  - `startQuiz` (189-209行目): 完了済みでも新規開始せず既存進捗を返す問題
  - `nextQuestion` (255-274行目): インデックス増加に上限チェックなし
- **Quiz.tsx**: 
  - 62-69行目: 開始時に完了チェックして結果画面へ遷移（正常）
  - 問題: 完了後に「続きから」で再度クイズを開始すると、既存の進捗が継続される

#### 修正方針
- `startQuiz` メソッドを修正：完了済みの場合は必ず新規開始
- または、完了時の「続きから」ボタンを「もう一度」に変更（課題2の対応で解決）

## 実装優先順位

1. **第1優先**: 進捗率100%超過問題の修正（データ整合性に関わる）
2. **第2優先**: カテゴリ進捗表示とボタンの修正（UX改善）
3. **第3優先**: 選択肢のA,B,C表記追加と不要な表示削除（UX改善）
4. **第4優先**: 「問題一覧」ボタンの削除または無効化（混乱回避）

## テスト計画

各修正後に以下のテストを実施：
1. 既存の117テストが全て成功することを確認
2. E2Eテストで実際の動作を確認
3. 修正箇所に対する新規テストケースの追加

## リスク評価

- **低リスク**: UI表示の修正が主で、ビジネスロジックへの影響は限定的
- **注意点**: LocalStorage のデータ構造は変更しない（既存ユーザーデータとの互換性維持）